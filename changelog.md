# 变更记录

## 2026-02-13

- 文档: 更新宪章与模板为中文，新增变更记录与提交规则。
- 文档: 宪章补充离线优先、结构化数据与产品约束，版本更新至 1.1.0。
- 文档: 补齐宪章生效日期（2026-02-13），版本更新至 1.1.1。
- 文档: 新增 001-menu-app 的 spec.md、plan.md、tasks.md。
- 前端: 初始化 Vite + React + TS，搭建基础路由与页面壳。
- 前端: 引入 Dexie 并创建本地数据库初始化骨架。
- 前端: 增加数据模型、排序/搜索工具与基础本地数据服务。
- 前端: 完成分类与菜品的基础数据接线与编辑表单。
- 前端: 菜单管理（新增/编辑/排序/备注）与详情展示接线。
- 前端: 增加 JSON 导出能力与设置页导出入口。
- 前端: 搜索增强（分类筛选、无结果提示、最近搜索）。
- 前端: 增加 JSON 导入能力（覆盖本地数据）。
- 前端: 增加软删除撤销（分类/菜品/菜单）。
- 前端: 首页支持按分类/按最近更新切换视图。
- 前端: 优化空态与操作提示，增强列表页可用性。
- 前端: 增加分类/菜品/菜单的基础校验与错误提示。
- 修复: 修正构建报错（未使用变量与类型导入）。
- 小程序: 初始化原生微信小程序骨架与本地存储服务。
- 小程序: 首页与分类页完成数据接线与基础交互。
- 小程序: 菜品列表页完成搜索/筛选/排序与跳转。
- 小程序: 菜品详情与编辑页完成数据接线与表单交互。
- 小程序: 菜单列表/详情/编辑页完成数据接线与排序备注。
- 小程序: 设置页完成 JSON 导出/导入能力。
- 小程序: 统一基础样式与空态样式，提升可读性。
- 小程序: 统一表单校验与错误提示（分类/菜品/菜单）。
- 小程序: 导入后广播数据变更，页面自动刷新。
- 小程序: 删除确认与撤销流程统一。
- 小程序: 增加数据修复流程与导入异常处理。
- 小程序: 修正 project.config.json 位置以便开发者工具识别。
- 小程序: 为直接打开 miniprogram 目录添加本地 project.config.json。
- 修复: 小程序菜单详情页 WXML 表达式错误。
- 修复: 小程序菜单编辑页 WXML 表达式错误。
- 小程序: 首页添加快捷入口；菜品难度使用中文显示。
- 小程序: 底部 TabBar 加入首页/分类/菜品/菜单/设置入口。
- 小程序: 底部 TabBar 添加图标并移除首页重复入口区块。
- 小程序: 菜单支持封面图片（新增/编辑/列表/详情）。
- 小程序: 新增菜单时支持设置封面图片。
- 小程序: 菜品支持图片上传与展示（新增/编辑/详情）。
- 小程序: 菜品列表页展示缩略图。
- 小程序: 导出完成后支持打开文档并保存/分享。
- 小程序: 设置页新增菜单展示图上传与视觉增强文案。
- 小程序: 设置页图片上传文案改为通用说明。
- 小程序: 设置页图片区块文案改为“这是我们的菜单”。
- 小程序: 设置页图片持久化，并改为点击图片替换。
- 小程序: 全局样式与模块排版优化，统一视觉风格。
- 小程序: 导出后优先使用分享面板，提升保存/转存兼容性。
- 小程序: 增加微信云开发同步与情侣共享邀请流程。
- 小程序: 设置页移除顶部模块并调整共享设置文案。
- 小程序: 共享设置改为可折叠面板。
- 小程序: 生成邀请码增加加载与失败提示。
- 修复: 共享设置加载提示与失败提示配对。
- 修复: 共享设置 loading 提示配对与防重入。
- 修复: 共享设置 loading 计数防止配对警告。
- 小程序: 同步时自动上传菜品/菜单封面并写入云端文件 ID。
- 小程序: 菜品/菜单列表与详情页支持通过云端文件 ID 展示图片。
- 修复: 数据修复逻辑补充菜单封面文件字段与重复字段清理。
- 修复: 分类名称唯一性校验改为忽略大小写与首尾空格。
- 小程序: 开启同步后自动触发一次同步，并在启动时自动尝试同步。
- 小程序: 生成邀请码支持创建新的共享空间并重置同步时间。
- 修复: 生成邀请码弹窗取消时不再卡住加载状态。
- 小程序: 新共享空间创建后支持一键清空本地数据。
- 小程序: 加入新共享空间时自动清空本地旧数据。
- 小程序: 全局 UI 改为温馨情侣风格（配色、卡片、按钮、输入与封面样式）。
- 小程序: JSON 导出包含图片数据，导入时自动恢复本地图片。
- 小程序: JSON 导出优先从云端拉取图片。
- 修复: iOS 导出后使用保存面板，避免弹窗停留在“去保存”状态。
- 修复: 导出保存失败时自动回退到分享/打开文件并输出错误日志。
- 小程序: 数据导入隐藏到“高级选项”折叠面板。
- 小程序: 导出也移动到高级选项，导入增加确认提示。
- 小程序: 设置页接入 Vant Weapp 组件（折叠、按钮、输入、开关）。
- 修复: Vant Switch 事件兼容，启用云同步可正常切换。
- 小程序: 分类/菜品/菜单/首页与详情编辑页切换为 Vant Weapp 输入与按钮样式。
- 小程序: 调整 Vant 按钮配色与操作区排布，避免按钮成列堆叠。
- 小程序: 分类操作按钮改为图标并使用柔和浅色系配色。
- 小程序: 分类操作按钮移到分类名后并增加浅色背景区分。
- 修复: 分类图标按钮布局压缩与自动换行，避免被挤出。
- 小程序: 菜品编辑用料/步骤改为自由文本输入，减少添加/删除操作。
- 小程序: 图片上传区统一为点击上传/点击替换样式。
- 小程序: 云同步补齐图库图片上传与同步元数据。
- 小程序: 同步时间显示改为年月日格式。
- 小程序: 分类编辑态输入框高亮显示，提升可见性。
- 小程序: 分类新增卡片布局优化，新增按钮改为淡蓝色。
- 小程序: 分类新增按钮改为与首页分段按钮一致的柔和粉色。
- 修复: 分类新增按钮强制使用柔和粉色渐变（Vant 主题覆盖）。
- 小程序: 全局主按钮改为柔和粉色渐变（替换绿色系按钮）。
- 修复: 强制覆盖 Vant 主按钮样式，避免页面仍显示绿色。
- 小程序: 菜单列表封面改为缩略图样式，布局与菜品列表一致。
- 小程序: 菜单列表右侧按钮改为纵向图标（编辑/删除）。
