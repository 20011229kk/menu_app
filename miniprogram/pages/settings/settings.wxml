<view class="container">
  <view class="card">
    <view class="section-title">这是我们的菜单</view>
    <view class="muted">这是我们的菜单</view>
    <view class="image-uploader" bindtap="chooseGalleryImage" style="margin-top: 12rpx;">
      <image wx:if="{{galleryImage}}" class="image-uploader-img" mode="widthFix" src="{{galleryImage}}" />
      <view wx:if="{{!galleryImage}}" class="image-uploader-placeholder">点击上传图片</view>
    </view>
</view>

<view wx:if="{{softToastVisible}}" class="soft-toast">{{softToastText}}</view>
  <van-collapse value="{{activePanels}}" bind:change="onCollapseChange">
    <van-collapse-item title="共享设置 💞" name="share">
      <van-cell title="启用云同步" custom-class="van-cell-soft">
        <van-switch
          slot="right-icon"
          size="22"
          checked="{{syncEnabled}}"
          active-color="#ff7aa2"
          bind:change="toggleSync"
        />
      </van-cell>
      <view wx:if="{{syncStatus}}" class="muted" style="margin: 8rpx 0 12rpx;">{{syncStatus}}</view>
      <view class="vant-actions">
        <van-button size="small" type="primary" bind:tap="createInviteCode">生成邀请码</van-button>
        <van-button size="small" type="default" bind:tap="syncNow">立即同步</van-button>
      </view>
      <view wx:if="{{inviteCode}}" class="muted" style="margin-top: 12rpx;">邀请码：{{inviteCode}}</view>
      <view class="vant-actions" style="margin-top: 12rpx;">
        <van-field
          label="邀请码"
          placeholder="输入邀请码"
          value="{{joinCode}}"
          bind:change="onJoinInput"
          custom-class="van-field-soft"
        />
        <van-button size="small" type="default" bind:tap="joinInviteCode">加入共享</van-button>
      </view>
    </van-collapse-item>

    <van-collapse-item title="高级选项 ⚙️" name="advanced">
      <van-cell
        title="数据导出 📦"
        label="导出为 JSON 文件用于备份（包含图片）"
        custom-class="van-cell-soft"
      >
        <van-button slot="right-icon" size="small" type="primary" bind:tap="exportData">导出</van-button>
      </van-cell>
      <van-cell
        title="数据导入 🔁"
        label="从 JSON 备份恢复数据（将覆盖当前数据）"
        custom-class="van-cell-soft"
      >
        <van-button slot="right-icon" size="small" type="default" bind:tap="importData">选择文件</van-button>
      </van-cell>
      <view wx:if="{{importResult}}" class="muted" style="margin-top: 8rpx;">{{importResult}}</view>
    </van-collapse-item>
  </van-collapse>
</view>
