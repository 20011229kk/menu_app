<view class="container">
  <view class="card">
    <view class="section-title">{{id ? '编辑菜品' : '新增菜品'}}</view>
    <view class="muted">菜名必填，用料与步骤可直接输入</view>
  </view>

  <view class="card">
    <view class="section-title">基础信息</view>
    <input class="input" placeholder="菜名" value="{{name}}" bindinput="onNameInput" />
    <input class="input" placeholder="一句话简介" value="{{description}}" bindinput="onDescriptionInput" />

    <view class="section-title" style="margin-top: 12rpx;">菜品图片</view>
    <view class="image-uploader" bindtap="chooseCoverImage">
      <image wx:if="{{coverImage}}" class="image-uploader-img" mode="widthFix" src="{{coverImage}}" />
      <view wx:if="{{!coverImage}}" class="image-uploader-placeholder">点击上传图片</view>
    </view>

    <picker mode="selector" range="{{categoryOptions}}" range-key="name" value="{{categoryIndex}}" bindchange="onCategoryChange">
      <view class="input">{{categoryOptions[categoryIndex].name}}</view>
    </picker>
    <view wx:if="{{categoryOptions.length === 1}}" class="muted">还没有分类，先去分类页创建。</view>
    <input class="input" placeholder="总时长(分钟)" type="number" value="{{cookTime}}" bindinput="onCookTimeInput" />
    <input class="input" placeholder="份量" type="number" value="{{servings}}" bindinput="onServingsInput" />
    <picker mode="selector" range="{{difficultyOptions}}" value="{{difficultyIndex}}" bindchange="onDifficultyChange">
      <view class="input">{{difficulty || '难度'}}
      </view>
    </picker>
    <textarea class="input" placeholder="要点/踩坑" value="{{tips}}" bindinput="onTipsInput" />
  </view>

  <view class="card">
    <view class="section-title">用料</view>
    <textarea
      class="input textarea"
      placeholder="例如：\n鸡胸肉 200g\n生抽 1 勺\n蒜末 适量"
      value="{{ingredientsText}}"
      auto-height="true"
      bindinput="onIngredientsInput"
    />
  </view>

  <view class="card">
    <view class="section-title">步骤</view>
    <textarea
      class="input textarea"
      placeholder="例如：\n1. 备料\n2. 热锅下油炒香\n3. 调味后出锅"
      value="{{stepsText}}"
      auto-height="true"
      bindinput="onStepsInput"
    />
  </view>

  <view class="button-primary" bindtap="saveDish">保存</view>
  <view wx:if="{{error}}" class="error">{{error}}</view>
</view>
