<view class="container">
  <view wx:if="{{dish}}" class="stack">
    <view class="card">
      <view class="cover-wrap">
        <image wx:if="{{coverUrl}}" class="cover" mode="widthFix" src="{{coverUrl}}" />
      </view>
      <view class="dish-header">
        <view class="section-title">{{dish.name}}</view>
        <view class="muted dish-desc">{{dish.description || '暂无简介'}}</view>
      </view>
      <view class="actions-wrap actions-row">
        <van-button size="small" type="default" custom-class="btn-inline-detail" bind:tap="goToEdit">编辑</van-button>
        <van-button size="small" type="danger" custom-class="btn-inline-detail" bind:tap="removeDish">删除</van-button>
      </view>
    </view>

    <view class="card">
      <view class="section-title">用料</view>
      <view wx:if="{{dish.ingredients.length === 0}}" class="muted">暂无用料</view>
      <view wx:for="{{dish.ingredients}}" wx:key="id" class="muted">
        {{item.name}} {{item.amount || ''}}{{item.unit || ''}} {{item.note ? '(' + item.note + ')' : ''}}
      </view>
    </view>

    <view class="card">
      <view class="section-title">步骤</view>
      <view wx:if="{{dish.steps.length === 0}}" class="muted">暂无步骤</view>
      <view wx:for="{{dish.steps}}" wx:key="id" class="muted">
        {{item.order}}. {{item.content}}
      </view>
    </view>

    <view wx:if="{{dish.tips}}" class="card">
      <view class="section-title">要点</view>
      <view class="muted">{{dish.tips}}</view>
    </view>
  </view>

  <view wx:if="{{!dish && !lastDeleted}}" class="card">
    <van-empty description="该菜品可能已被删除。" />
  </view>

  <view wx:if="{{lastDeleted}}" class="card undo-bar">
    <view>已删除菜品：{{lastDeleted.name}}</view>
    <van-button size="small" type="default" bind:tap="undoDelete">撤销</van-button>
  </view>
</view>

<view wx:if="{{softToastVisible}}" class="soft-toast">{{softToastText}}</view>
