# 功能规范: 轻量离线优先菜单/菜谱管理

**功能分支**: `[001-menu-app]`  
**创建日期**: 2026-02-13  
**状态**: 草稿  
**输入**: 用户描述: "离线优先的菜单/菜谱管理小程序"

## 用户场景与测试 *(必须)*

### 用户故事 1 - 管理菜品与分类（优先级: P1）

作为用户，我需要新增、编辑、删除分类与菜品，并能在离线状态下完成操作，
以便快速搭建自己的菜谱库并随时使用。

**为何此优先级**: 菜品与分类是核心数据资产，必须优先可用且离线可用。

**独立测试**: 仅实现分类与菜品管理即可形成可用 MVP。

**验收场景**:

1. **给定** 空数据，**当** 新增“热菜”分类并排序，**则** 分类列表展示且排序生效。
2. **给定** 已有分类，**当** 新增“宫保鸡丁”并选择分类，**则** 菜品显示在该分类下。

---

### 用户故事 2 - 管理菜单（优先级: P2）

作为用户，我需要创建菜单并从已有菜品中选择组合，
以便复用一组菜品并快速查看每道菜的做法。

**为何此优先级**: 菜单组合是高频复用场景，但可在菜品完成后迭代。

**独立测试**: 在已有菜品的前提下创建菜单并查看详情。

**验收场景**:

1. **给定** 已有菜品，**当** 创建菜单并添加菜品、调整顺序与备注，**则** 菜单详情按顺序展示。

---

### 用户故事 3 - 检索与备份（优先级: P3）

作为用户，我需要快速搜索菜品，并能导出数据进行备份，
以便快速找到内容并确保数据安全。

**为何此优先级**: 提升效率与安全性，但可在核心流程稳定后加入。

**独立测试**: 仅实现搜索与导出即可验证该故事。

**验收场景**:

1. **给定** 多个菜品，**当** 搜索关键字，**则** 返回匹配菜名/描述/用料的结果。

---

### 边界与异常

- 当删除分类时，菜品不被删除且分类变为“未分类”。
- 当硬删除菜品时需二次确认；若采用软删除需可撤销。
- 当离线时，新增/编辑/删除功能仍可用。
- 当数据为空时，列表仍提供新增入口且空态清晰。

## 需求 *(必须)*

### 功能需求

- **FR-001**: 系统必须支持新增/编辑/删除分类，并支持排序。
- **FR-002**: 系统必须支持新增/编辑/删除菜品，菜名为必填项。
- **FR-003**: 菜品用料与步骤必须支持动态增删与顺序调整。
- **FR-004**: 菜品列表必须支持按分类分组，并可切换分类内排序方式。
- **FR-005**: 系统必须提供菜名关键字搜索，且至少覆盖菜名字段。
- **FR-006**: 系统必须支持新增/编辑/删除菜单，并在菜单内排序与备注。
- **FR-007**: 菜单详情必须支持跳转到菜品详情查看做法。
- **FR-008**: 数据必须优先本地保存，离线可用，同步为可选能力。
- **FR-009**: 系统必须提供 JSON 导出作为基础备份通道。
- **FR-010**: 删除分类时不得删除菜品，菜品分类置空。
- **FR-011**: 所有列表必须具备明确且一致的排序规则。
- **FR-012**: 所有实体必须使用稳定唯一 ID（UUID/ULID）。

### 关键实体 *(如涉及数据)*

- **Category**: 分类实体（id, name, order, createdAt, updatedAt）
- **Dish**: 菜品/菜谱实体（id, name, categoryId?, description?, ingredients[], steps[], cookTime?, servings?, difficulty?, tips?, createdAt, updatedAt）
- **Menu**: 菜单实体（id, name, items[], createdAt, updatedAt）

## 成功标准 *(必须)*

### 可度量结果

- **SC-001**: 新增菜谱进入编辑态不超过 3 次点击。
- **SC-002**: 在 500 条菜品规模下，搜索返回结果的可感知等待小于 300ms。
- **SC-003**: 离线状态下完成新增菜品流程的成功率为 100%。
- **SC-004**: 导出 JSON 可完整还原 Category、Dish、Menu 结构（字段无丢失）。

## 非目标（本期不做）

- 标签与高级过滤
- 份量缩放
- 图片/视频步骤
- 购物清单
- 多设备同步/共享菜单
